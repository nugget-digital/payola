AWSTemplateFormatVersion: 2010-09-09
Description: Payola Api Distribution Stack

Resources:

  PayolaRestApi:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Name: PayolaRestApi
      ApiKeySourceType: X-Api-Key
      EndpointConfiguration: PRIVATE
      # Body: # Flag serves as a placeholder for openapi.yml
      #   OPENAPI

  LambdaExecutionRole:
  Type: AWS::IAM::Role
  Properties:
    AssumeRolePolicyDocument:
      Version: 2012-10-17
      Statement:
      - Effect: Allow
        Prinipal:
          Service:
            - lambda.amazonaws.com
        Action:
          - "sts:AssumeRole"
    Policies:
      - PolicyName: LambdaExecutionPolicy
        PolicyDocument:
          Version: 2012-10-17
          Statement:
            - Effect: Allow
              Action:
                - dynamodb:GetItem
                - dynamodb:PutItem

  CreateClaim:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: rust
      Handler: handler.createClaim
#      Role:

  GetClaimStatus:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: rust
      Handler: handler.getClaimStatus
#      Role:

  UpdateClaim:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: rust
      Handler: handler.updateClaim
#      Role:

  StoreClaim:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: rust
      Handler: handler.storeClaim
#      Role:

  GetBalance:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: rust
      Handler: handler.getBalance
#      Role:

  GetConfig:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: rust
      Handler: handler.getConfig
#      Role:
